"use strict";(globalThis.webpackChunkwalrus_docusaurus=globalThis.webpackChunkwalrus_docusaurus||[]).push([[4201],{4616(t,e,i){i.r(e),i.d(e,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});let s=JSON.parse('{"id":"system-overview/quilt","title":"Quilt: Walrus Native Batch Store Tool","description":"Comprehensive guide to Walrus Quilt for batch storage of multiple small blobs with cost optimization and metadata management.","source":"@site/../content/system-overview/quilt.mdx","sourceDirName":"system-overview","slug":"/system-overview/quilt","permalink":"/docs/system-overview/quilt","draft":false,"unlisted":false,"editUrl":"https://github.com/MystenLabs/walrus/tree/main/docs/../content/system-overview/quilt.mdx","tags":[],"version":"current","frontMatter":{"title":"Quilt: Walrus Native Batch Store Tool","description":"Comprehensive guide to Walrus Quilt for batch storage of multiple small blobs with cost optimization and metadata management.","keywords":["walrus","quilt","batch storage","cost optimization","small blobs","metadata","efficiency","storage tool","quilt patch id"]},"sidebar":"docsSidebar","previous":{"title":"Available Networks","permalink":"/docs/system-overview/available-networks"},"next":{"title":"Storing Blobs","permalink":"/docs/walrus-client/storing-blobs"}}');var n=i(2615),l=i(5756);let a={title:"Quilt: Walrus Native Batch Store Tool",description:"Comprehensive guide to Walrus Quilt for batch storage of multiple small blobs with cost optimization and metadata management.",keywords:["walrus","quilt","batch storage","cost optimization","small blobs","metadata","efficiency","storage tool","quilt patch id"]},o,r={},d=[{value:"Important considerations",id:"important-considerations",level:2},{value:"Target use cases",id:"target-use-cases",level:2},{value:"Lower cost",id:"lower-cost",level:3},{value:"Organize collections",id:"organize-collections",level:3},{value:"Walrus native blob metadata",id:"walrus-native-blob-metadata",level:3}];function c(t){let e={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...t.components},{Term:i}=e;return i||function(t,e){throw Error("Expected "+(e?"component":"object")+" `"+t+"` to be defined: you likely forgot to import, pass, or provide it.")}("Term",!0),(0,n.jsxs)(n.Fragment,{children:["\n",(0,n.jsxs)(e.p,{children:["Quilt is a batch storage feature, designed to optimize the storage cost and efficiency of large numbers of small ",(0,n.jsx)(i,{lookup:"Blob",children:"blobs"}),". Prior to Quilt, storing small ","blobs"," (less than 10 MB) on Walrus involved higher per-byte costs due to internal system data overhead. Quilt addresses this by encoding multiple (up to 666 for QuiltV1) ","blobs"," into a single unit called a ",(0,n.jsx)(e.strong,{children:"quilt"}),", significantly reducing Walrus storage overhead and lowering costs to purchase Walrus and Sui storage, as well as Sui computation gas fees."]}),"\n",(0,n.jsxs)(e.p,{children:["Importantly, each ","blob"," within a quilt can be accessed and retrieved individually without needing to download the entire quilt. Moreover, the ","blob"," boundaries in a quilt align with Walrus internal structures and Walrus ",(0,n.jsx)(i,{lookup:"Storage node",children:"storage nodes"}),", allowing for retrieval latency that is comparable to, or even lower than, that of a regular ","blob","."]}),"\n",(0,n.jsxs)(e.p,{children:["Quilt introduces custom, immutable Walrus-native ",(0,n.jsx)(i,{lookup:"Blob metadata",children:"blob metadata"}),", allowing you to assign different types of metadata to each ","blob"," in a quilt, for example, unique identifiers and tags of key-value pairs. This metadata is functionally similar to the existing ","blob metadata"," store on-chain, however, there are some fundamental distinctions. First, Walrus-native metadata is stored alongside the ","blob"," data, and hence it reduces costs and simplifies management. Second, this metadata can be used for efficient lookup of ","blobs"," within a quilt, for example, reading ","blobs"," with a particular tag. When storing a quilt, you can set the Walrus-native metadata using the Quilt APIs."]}),"\n",(0,n.jsxs)(e.admonition,{type:"warning",children:[(0,n.jsx)(e.p,{children:"An identifier must start with an alphanumeric character contain no trailing whitespace, and not exceed 64 KB in length."}),(0,n.jsx)(e.p,{children:"The total size of all tags combined must not exceed 64 KB."})]}),"\n",(0,n.jsx)(e.h2,{id:"important-considerations",children:"Important considerations"}),"\n",(0,n.jsxs)(e.p,{children:["Blobs"," stored in a quilt are assigned a unique ID, called ",(0,n.jsx)(e.code,{children:"QuiltPatchId"}),", that differs from the ",(0,n.jsx)(e.code,{children:"BlobId"})," used for regular Walrus ","blobs",". A ",(0,n.jsx)(e.code,{children:"QuiltPatchId"})," is determined by the composition of the entire quilt, rather than the single ","blob",", and hence it can change if the ","blob"," is stored in a different quilt. Moreover, individual ","blobs"," cannot be deleted, extended, or shared separately. These operations can only be applied to the entire quilt."]}),"\n",(0,n.jsx)(e.h2,{id:"target-use-cases",children:"Target use cases"}),"\n",(0,n.jsxs)(e.p,{children:["Using Quilt requires minimal additional effort beyond standard procedures. The primary considerations are that the unique ID assigned to each ","blob"," within a quilt cannot be directly derived from its contents."]}),"\n",(0,n.jsx)(e.h3,{id:"lower-cost",children:"Lower cost"}),"\n",(0,n.jsxs)(e.p,{children:["Quilt is especially advantageous for managing large volumes of small ","blobs",", as long as they can be grouped together by the ",(0,n.jsx)(i,{lookup:"User",children:"user"}),". The cost savings come from 2 sources:"]}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"Walrus storage and write fees"}),": By consolidating multiple small ","blobs"," into a single quilt, storage costs can be reduced dramatically, more than 400x for files around 10 KB, making it an efficient solution for cost-sensitive applications."]}),"\n"]}),"\n",(0,n.jsxs)(e.li,{children:["\n",(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:"Sui computation and object storage fees"}),": Storing many ","blobs"," as a single quilt significantly reduces Sui gas costs. In test runs with 600 files stored in a quilt, 238x savings in Sui fees were observed compared to storing them as individual ","blobs",". Notably, Sui cost savings only depend on the number of files per quilt rather than the individual file sizes."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(e.p,{children:["The following table demonstrates the potential cost savings in ",(0,n.jsx)(i,{lookup:"WAL",children:"WAL"})," when storing 600 small ","blobs"," for 1 epoch as a quilt compared to storing them as separate ","blobs","."]}),"\n",(0,n.jsxs)(e.table,{children:[(0,n.jsx)(e.thead,{children:(0,n.jsxs)(e.tr,{children:[(0,n.jsxs)(e.th,{style:{textAlign:"right"},children:["Blob"," size"]}),(0,n.jsxs)(e.th,{style:{textAlign:"right"},children:["Regular ","blob"," storage cost"]}),(0,n.jsx)(e.th,{style:{textAlign:"right"},children:"Quilt storage cost"}),(0,n.jsx)(e.th,{style:{textAlign:"right"},children:"Cost saving factor"})]})}),(0,n.jsxs)(e.tbody,{children:[(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"10KB"}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["2.088 ","WAL"]}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["0.005 ","WAL"]}),(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"409x"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"50KB"}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["2.088 ","WAL"]}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["0.011 ","WAL"]}),(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"190x"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"100KB"}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["2.088 ","WAL"]}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["0.020 ","WAL"]}),(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"104x"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"200KB"}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["2.088 ","WAL"]}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["0.036 ","WAL"]}),(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"58x"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"500KB"}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["2.136 ","WAL"]}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["0.084 ","WAL"]}),(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"25x"})]}),(0,n.jsxs)(e.tr,{children:[(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"1MB"}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["2.208 ","WAL"]}),(0,n.jsxs)(e.td,{style:{textAlign:"right"},children:["0.170 ","WAL"]}),(0,n.jsx)(e.td,{style:{textAlign:"right"},children:"13x"})]})]})]}),"\n",(0,n.jsx)(e.admonition,{type:"info",children:(0,n.jsxs)(e.p,{children:["The costs shown in this table are for illustrative purposes only and were obtained from test runs on Walrus Testnet. Actual costs can vary due to changes in smart contract parameters, networks, and other factors. The comparison is between storing 600 files as a single quilt versus storing them as individual ","blobs"," in batches of 25."]})}),"\n",(0,n.jsx)(e.h3,{id:"organize-collections",children:"Organize collections"}),"\n",(0,n.jsxs)(e.p,{children:["Quilt provides a straightforward way to organize and manage collections of small ","blobs"," within a single unit. This can simplify data handling and improve operational efficiency when working with related small files, such as NFT image collections."]}),"\n",(0,n.jsxs)(e.h3,{id:"walrus-native-blob-metadata",children:["Walrus native ","blob metadata"]}),"\n",(0,n.jsxs)(e.p,{children:["Quilt supports immutable, custom metadata stored directly in Walrus, including identifiers and tags. These features facilitate better organization, enable flexible lookup, and assist in managing ","blobs"," within each quilt, enhancing retrieval and management processes."]}),"\n",(0,n.jsxs)(e.p,{children:["For details on how to use the CLI to interact with Quilt, see the ",(0,n.jsx)(e.a,{href:"/docs/walrus-client/storing-blobs#batch-store",children:"Batch-storing blobs with quilts"})," section."]})]})}function h(t={}){let{wrapper:e}={...(0,l.R)(),...t.components};return e?(0,n.jsx)(e,{...t,children:(0,n.jsx)(c,{...t})}):c(t)}},5756(t,e,i){i.d(e,{R:()=>a,x:()=>o});var s=i(9471);let n={},l=s.createContext(n);function a(t){let e=s.useContext(l);return s.useMemo(function(){return"function"==typeof t?t(e):{...e,...t}},[e,t])}function o(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(n):t.components||n:a(t.components),s.createElement(l.Provider,{value:e},t.children)}}}]);