"use strict";(globalThis.webpackChunkwalrus_docusaurus=globalThis.webpackChunkwalrus_docusaurus||[]).push([[2420],{4368(e,t,n){n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>c,frontMatter:()=>r,metadata:()=>i,toc:()=>d});let i=JSON.parse('{"id":"http-api/quilt-http-apis","title":"Quilt HTTP APIs","description":"{/ https://linear.app/mysten-labs/issue/DOCS-646/http-apireading-blobs /}","source":"@site/../content/http-api/quilt-http-apis.mdx","sourceDirName":"http-api","slug":"/http-api/quilt-http-apis","permalink":"/docs/http-api/quilt-http-apis","draft":false,"unlisted":false,"editUrl":"https://github.com/MystenLabs/walrus/tree/main/docs/../content/http-api/quilt-http-apis.mdx","tags":[],"version":"current","frontMatter":{"title":"Quilt HTTP APIs"},"sidebar":"docsSidebar","previous":{"title":"Reading Blobs","permalink":"/docs/http-api/reading-blobs"},"next":{"title":"SDKs","permalink":"/docs/typescript-sdk/sdks"}}');var s=n(2615),l=n(5756);let r={title:"Quilt HTTP APIs"},a,o={},d=[{value:"Storing quilts",id:"storing-quilts",level:3},{value:"Reading quilts",id:"reading-quilts",level:3},{value:"Quilt patch ID",id:"quilt-patch-id",level:5},{value:"Quilt ID and identifier",id:"quilt-id-and-identifier",level:5}];function u(e){let t={a:"a",code:"code",h3:"h3",h5:"h5",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components},{Term:n}=t;return n||function(e,t){throw Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Term",!0),(0,s.jsxs)(s.Fragment,{children:["\n",(0,s.jsxs)(t.p,{children:["Walrus supports storing and retrieving multiple ",(0,s.jsx)(n,{lookup:"Blob",children:"blobs"})," as a single unit called a ",(0,s.jsx)(t.a,{href:"/docs/system-overview/quilt",children:"quilt"}),". Publishers and aggregators both support quilt operations."]}),"\n",(0,s.jsx)(t.h3,{id:"storing-quilts",children:"Storing quilts"}),"\n",(0,s.jsxs)(t.p,{children:["All query parameters available for ",(0,s.jsx)(t.a,{href:"#store",children:"storing regular blobs"})," can also be used when storing quilts."]}),"\n",(0,s.jsxs)(t.p,{children:["Use the following ",(0,s.jsx)(n,{lookup:"Publisher",children:"publisher"})," API to store multiple ","blobs"," as a quilt."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'# Store 2 files `document.pdf` and `image.png`, with custom identifiers `contract-v2` and `logo-2024`, respectively:\n$ curl -X PUT "$PUBLISHER/v1/quilts?epochs=5" \\\n  -F "contract-v2=@document.pdf" \\\n  -F "logo-2024=@image.png"\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Identifiers must be unique within a quilt and cannot start with ",(0,s.jsx)(t.code,{children:"_"}),". The field name ",(0,s.jsx)(t.code,{children:"_metadata"})," is reserved for Walrus native metadata and does not conflict with ",(0,s.jsx)(n,{lookup:"User",children:"user"}),"-defined identifiers. See the ",(0,s.jsx)(t.a,{href:"/docs/system-overview/quilt",children:"Quilt documentation"})," for complete identifier restrictions."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'# Store 2 files with Walrus-native metadata. `_metadata` must be used as the field name for Walrus native metadata\n$ curl -X PUT "$PUBLISHER/v1/quilts?epochs=5" \\\n  -F "quilt-manual=@document.pdf" \\\n  -F "logo-2025=@image.png" \\\n  -F \'_metadata=[\n    {"identifier": "quilt-manual", "tags": {"creator": "walrus", "version": "1.0"}},\n    {"identifier": "logo-2025", "tags": {"type": "logo", "format": "png"}}\n  ]\'\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The quilt store API returns a JSON response with information about the stored quilt, including the quilt ID (",(0,s.jsx)(t.code,{children:"blobId"}),") and individual ","blob"," patch IDs that can be used to retrieve specific ","blobs"," later. The following example shows the command and response. The actual JSON output is returned as a single line and is formatted on this page for readability:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'$ curl -X PUT "http://127.0.0.1:31415/v1/quilts?epochs=1" \\\n  -F "walrus.jpg=@./walrus-33.jpg" \\\n  -F "another_walrus.jpg=@./walrus-46.jpg"\n'})}),"\n",(0,s.jsx)(t.p,{children:"If successful, the console responds:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'{\n  "blobStoreResult": {\n    "newlyCreated": {\n    "blobObject": {\n        "id": "0xe6ac1e1ac08a603aef73a34328b0b623ffba6be6586e159a1d79c5ef0357bc02",\n        "registeredEpoch": 103,\n        "blobId": "6XUOE-Q5-nAXHRifN6n9nomVDtHZQbGuAkW3PjlBuKo",\n        "size": 1782224,\n        "encodingType": "RS2",\n        "certifiedEpoch": null,\n        "storage": {\n        "id": "0xbc8ff9b4071927689d59468f887f94a4a503d9c6c5ef4c4d97fcb475a257758f",\n        "startEpoch": 103,\n        "endEpoch": 104,\n        "storageSize": 72040000\n        },\n        "deletable": false\n    },\n    "resourceOperation": {\n        "registerFromScratch": {\n        "encodedLength": 72040000,\n        "epochsAhead": 1\n        }\n    },\n    "cost": 12075000\n    }\n  },\n  "storedQuiltBlobs": [\n    {\n    "identifier": "another_walrus.jpg",\n    "quiltPatchId": "6XUOE-Q5-nAXHRifN6n9nomVDtHZQbGuAkW3PjlBuKoBAQDQAA"\n    },\n    {\n    "identifier": "walrus.jpg",\n    "quiltPatchId": "6XUOE-Q5-nAXHRifN6n9nomVDtHZQbGuAkW3PjlBuKoB0AB7Ag"\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(t.h3,{id:"reading-quilts",children:"Reading quilts"}),"\n",(0,s.jsxs)(t.p,{children:["You can retrieve ","blobs"," from a quilt through the ",(0,s.jsx)(n,{lookup:"Aggregator",children:"aggregator"})," APIs using their quilt patch ID or their quilt ID and unique identifier. Currently, only 1 ","blob"," can be retrieved per request. Bulk retrieval of multiple ","blobs"," from a quilt in a single request is not yet supported."]}),"\n",(0,s.jsx)(t.h5,{id:"quilt-patch-id",children:"Quilt patch ID"}),"\n",(0,s.jsxs)(t.p,{children:["Each ","blob"," in a quilt has a unique patch ID. You can retrieve a specific ","blob"," using its patch ID."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'# Retrieve a blob using its quilt patch ID:\n$ curl "$AGGREGATOR/v1/blobs/by-quilt-patch-id/6XUOE-Q5-nAXHRifN6n9nomVDtHZQbGuAkW3PjlBuKoBAQDQAA" \\\n'})}),"\n",(0,s.jsxs)(t.p,{children:["You can obtain ",(0,s.jsx)(t.code,{children:"QuiltPatchIds"})," from the store quilt output or by using the ",(0,s.jsx)(t.a,{href:"/docs/walrus-client/storing-blobs#batch-store",children:(0,s.jsx)(t.code,{children:"list-patches-in-quilt"})})," CLI command."]}),"\n",(0,s.jsx)(t.h5,{id:"quilt-id-and-identifier",children:"Quilt ID and identifier"}),"\n",(0,s.jsxs)(t.p,{children:["You can also retrieve a ","blob"," using the quilt ID and the ","blob","'s identifier."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:'# Retrieve a blob with identifier `walrus.jpg` from the quilt:\n$ curl "$AGGREGATOR/v1/blobs/by-quilt-id/6XUOE-Q5-nAXHRifN6n9nomVDtHZQbGuAkW3PjlBuKo/walrus.jpg" \\\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Both methods return the raw ","blob"," bytes in the response body. Metadata such as the ",(0,s.jsx)(n,{lookup:"Blob ID",children:"blob ID"})," and tags are returned as HTTP headers:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"X-Quilt-Patch-Identifier"}),": The identifier of the ","blob"," within the quilt"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"ETag"}),": The patch ID or quilt ID for caching purposes"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["Additional custom headers from ","blob"," tags, if configured"]}),"\n"]}),"\n"]})]})}function c(e={}){let{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},5756(e,t,n){n.d(t,{R:()=>r,x:()=>a});var i=n(9471);let s={},l=i.createContext(s);function r(e){let t=i.useContext(l);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(l.Provider,{value:t},e.children)}}}]);