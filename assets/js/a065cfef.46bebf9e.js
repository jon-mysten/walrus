"use strict";(globalThis.webpackChunkwalrus_docusaurus=globalThis.webpackChunkwalrus_docusaurus||[]).push([[8729],{5248(e,i,s){s.r(i),s.d(i,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>d});let t=JSON.parse('{"id":"walrus-client/storing-blobs","title":"Storing Blobs","description":"{/ https://linear.app/mysten-labs/issue/DOCS-639/walrus-clientstoring-blobs /}","source":"@site/../content/walrus-client/storing-blobs.mdx","sourceDirName":"walrus-client","slug":"/walrus-client/storing-blobs","permalink":"/docs/walrus-client/storing-blobs","draft":false,"unlisted":false,"editUrl":"https://github.com/MystenLabs/walrus/tree/main/docs/../content/walrus-client/storing-blobs.mdx","tags":[],"version":"current","frontMatter":{"title":"Storing Blobs"},"sidebar":"docsSidebar","previous":{"title":"Quilt: Walrus Native Batch Store Tool","permalink":"/docs/system-overview/quilt"},"next":{"title":"Reading Blobs","permalink":"/docs/walrus-client/reading-blobs"}}');var n=s(2615),o=s(5756);let l={title:"Storing Blobs"},r,a={},d=[{value:"Store blobs",id:"store-blobs",level:2},{value:"Blob lifetimes",id:"blob-lifetimes",level:3},{value:"Blob permanence",id:"blob-permanence",level:3},{value:"Automatic optimizations",id:"automatic-optimizations",level:3},{value:"Use a Walrus upload relay",id:"use-a-walrus-upload-relay",level:3},{value:"Store blobs as a quilt",id:"store-blobs-as-a-quilt",level:2}];function c(e){let i={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components},{ImportContent:s,Term:t}=i;return s||u("ImportContent",!0),t||u("Term",!0),(0,n.jsxs)(n.Fragment,{children:["\n",(0,n.jsxs)(i.p,{children:["Use the command-line interface (CLI) to interact with the ",(0,n.jsx)(t,{lookup:"Client",children:"Walrus client"}),". The CLI is available through installing the ",(0,n.jsx)(i.code,{children:"walrus"})," binary. See the ",(0,n.jsx)(i.a,{href:"/docs/getting-started",children:"getting started documentation"})," for prerequisites, installation, and configuration."]}),"\n",(0,n.jsx)(i.p,{children:"Detailed usage information including a full list of available commands can be viewed using:"}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-sh",children:"$ walrus --help\n"})}),"\n",(0,n.jsxs)(i.p,{children:["Each subcommand of ",(0,n.jsx)(i.code,{children:"walrus"})," can also be called with ",(0,n.jsx)(i.code,{children:"--help"})," to print its specific arguments and their meaning."]}),"\n",(0,n.jsxs)(i.p,{children:["If you have multiple contexts in your configuration file, you can specify the context for each command using the ",(0,n.jsx)(i.code,{children:"--context"})," option. You can generate a ",(0,n.jsx)(i.code,{children:"bash"}),", ",(0,n.jsx)(i.code,{children:"zsh"}),", or ",(0,n.jsx)(i.code,{children:"fish"})," completion script with ",(0,n.jsx)(i.code,{children:"walrus completion"})," and place it in an appropriate directory like ",(0,n.jsx)(i.code,{children:"~/.local/share/bash-completion/completions"}),"."]}),"\n",(0,n.jsxs)(i.h2,{id:"store-blobs",children:["Store ",(0,n.jsx)(t,{lookup:"Blob",children:"blobs"})]}),"\n",(0,n.jsxs)(i.p,{children:["All ","blobs"," stored in Walrus are public and discoverable by all. To store sensitive data, use ",(0,n.jsx)(i.a,{href:"/docs/data-security#seal-data-confidentially-and-access-control",children:"Seal"})," or ",(0,n.jsx)(i.a,{href:"/docs/data-security#nautilus-secure-and-verifiable-off-chain-computation",children:"Nautilus"})," to encrypt the data before storing it on Walrus."]}),"\n",(0,n.jsxs)(i.p,{children:["Store ","blobs"," on Walrus with the following command:"]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-sh",children:"$ walrus store <FILES> --epochs <EPOCHS>\n"})}),"\n",(0,n.jsx)(s,{source:"blob-object-id",mode:"snippet"}),"\n",(0,n.jsxs)(i.p,{children:["You can store a single file or multiple files, separated by spaces. Notably, this is compatible with glob patterns; for example, ",(0,n.jsx)(i.code,{children:"walrus store *.png --epochs <EPOCHS>"})," stores all PNG files in the current directory."]}),"\n",(0,n.jsxs)(i.h3,{id:"blob-lifetimes",children:["Blob"," lifetimes"]}),"\n",(0,n.jsxs)(i.p,{children:["A mandatory CLI argument must be set to specify the lifetime for the ","blob",". There are currently 3 methods of setting a ","blob","'s lifetime:"]}),"\n",(0,n.jsxs)(i.ol,{children:["\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["The ",(0,n.jsx)(i.code,{children:"--epochs <EPOCHS>"})," option indicates the number of epochs the ","blob"," should be stored for. There is an upper limit on the number of epochs a ","blob"," can be stored for, which is 53 and corresponds to 2 years. In addition to a positive integer, you can also use ",(0,n.jsx)(i.code,{children:"--epochs max"})," to store the ","blob"," for the maximum number of epochs. The end epoch is defined as the current epoch plus the specified number of epochs."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["The ",(0,n.jsx)(i.code,{children:"--earliest-expiry-time <EARLIEST_EXPIRY_TIME>"})," option takes a date in either RFC3339 format (for example, ",(0,n.jsx)(i.code,{children:"2024-03-20T15:00:00Z"}),") or a more relaxed format (for example, ",(0,n.jsx)(i.code,{children:"2024-03-20 15:00:00"}),"). It ensures the ","blob"," expires after the specified date if possible."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["The ",(0,n.jsx)(i.code,{children:"--end-epoch <END_EPOCH>"})," option takes a specific end epoch for the ","blob","."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(i.p,{children:["A ","blob"," expires at the beginning of its end epoch. For example, a ","blob"," with end epoch ",(0,n.jsx)(i.code,{children:"314"})," becomes unavailable at the beginning of epoch ",(0,n.jsx)(i.code,{children:"314"}),". One consequence of this is that when storing a ","blob"," with ",(0,n.jsx)(i.code,{children:"--epochs 1"})," immediately before an epoch change, it expires and becomes unavailable almost immediately. ","Blobs"," can be ",(0,n.jsx)(i.a,{href:"#extend-the-lifetime-of-a-blob",children:"extended"})," only if they have not expired."]}),"\n",(0,n.jsxs)(i.h3,{id:"blob-permanence",children:["Blob"," permanence"]}),"\n",(0,n.jsxs)(i.p,{children:["You can specify whether a newly stored ","blob"," is deletable or permanent through the ",(0,n.jsx)(i.code,{children:"--deletable"})," and ",(0,n.jsx)(i.code,{children:"--permanent"})," option, respectively:"]}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["A ",(0,n.jsx)(t,{lookup:"Permanent blob",children:"permanent blob"})," remains available until its ",(0,n.jsx)(t,{lookup:"Expiry",children:"expiry"})," epoch. Not even the uploader can delete it beforehand."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["In contrast, a ",(0,n.jsx)(t,{lookup:"Deletable blob",children:"deletable blob"})," can be deleted at any point during its lifetime by the owner of the corresponding Sui object. See the ",(0,n.jsx)(i.a,{href:"#reclaim-space-through-deletable-blobs",children:"deletable blobs"})," for more details."]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(i.p,{children:["Newly stored ","blobs"," are deletable by default."]}),"\n",(0,n.jsx)(i.h3,{id:"automatic-optimizations",children:"Automatic optimizations"}),"\n",(0,n.jsxs)(i.p,{children:["When storing a ","blob",", the ","client"," performs a number of automatic optimizations, including the following:"]}),"\n",(0,n.jsxs)(i.ul,{children:["\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["If the ","blob"," is already stored as a ","permanent blob"," on Walrus for a sufficient number of epochs, the command does not store it again. This behavior can be overwritten with the ",(0,n.jsx)(i.code,{children:"--force"})," CLI option, which stores the ","blob"," again and creates a fresh Sui object belonging to the wallet address."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["If the ",(0,n.jsx)(t,{lookup:"User",children:"user"}),"'s wallet has a storage resource of suitable size and duration, it is used instead of requiring that the ","user"," buy a new one."]}),"\n"]}),"\n",(0,n.jsxs)(i.li,{children:["\n",(0,n.jsxs)(i.p,{children:["If the ","blob"," is already certified on Walrus but it is a ","deletable blob"," or it is not stored for a sufficient number of epochs, the command skips sending encoded ","blob"," data to the ",(0,n.jsx)(t,{lookup:"Storage node",children:"storage nodes"})," and just collects the availability certificate."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(i.h3,{id:"use-a-walrus-upload-relay",children:"Use a Walrus upload relay"}),"\n",(0,n.jsxs)(i.p,{children:["A Walrus upload relay is a third party service that can help clients with limited bandwidth and networking capabilities such as a browser, for example, in storing ","blobs"," on Walrus."]}),"\n",(0,n.jsxs)(i.p,{children:["Asset management on-chain still happens on the ","client",". The upload relay just takes the unencoded ","blob",", encodes it, and sends the slivers to the ","storage nodes",", before returning the certificate. See in-depth details in the ",(0,n.jsx)(i.a,{href:"/docs/operator-guide/upload-relay",children:"Walrus upload relay"})," documentation."]}),"\n",(0,n.jsxs)(i.p,{children:["When storing ","blobs"," with the ",(0,n.jsx)(i.code,{children:"walrus store"})," command, and also when ",(0,n.jsx)(i.a,{href:"#store-blobs-as-a-quilt",children:"storing quilts"}),", you can use the ",(0,n.jsx)(i.code,{children:"--upload-relay"})," flag with a URL to specify an upload relay server be used by the CLI."]}),"\n",(0,n.jsx)(i.p,{children:"The Walrus upload relay functionality is only available in the Walrus CLI version v1.29 or higher."}),"\n",(0,n.jsxs)(i.p,{children:["The upload relay is a third party service that might require a fee or tip. This tip might be a constant SUI amount per ","blob"," stored, or it might be dependent on the size of the ","blob"," being stored. The Walrus CLI shows you how much tip the upload relay requires and asks for confirmation before continuing."]}),"\n",(0,n.jsxs)(i.p,{children:["View technical details on how the tip is ",(0,n.jsx)(i.a,{href:"/docs/operator-guide/upload-relay",children:"computed and paid"}),"."]}),"\n",(0,n.jsxs)(i.h2,{id:"store-blobs-as-a-quilt",children:["Store ","blobs"," as a quilt"]}),"\n",(0,n.jsxs)(i.p,{children:["For efficiently storing large numbers of small ","blobs",", Walrus provides the Quilt. It batches multiple ","blobs"," into a single storage unit, significantly reducing overhead and cost. You can find a more detailed overview of the feature ",(0,n.jsx)(i.a,{href:"/docs/system-overview/quilt",children:"Quilt"}),"."]}),"\n",(0,n.jsxs)(i.p,{children:["You can interact with quilts using a dedicated set of ",(0,n.jsx)(i.code,{children:"walrus"})," subcommands."]}),"\n",(0,n.jsxs)(i.p,{children:["Blobs"," within a quilt are retrieved by a ",(0,n.jsx)(i.code,{children:"QuiltPatchId"}),", not their standard ",(0,n.jsx)(i.code,{children:"BlobId"}),". This ID is generated based on all ","blobs"," in the quilt, so a ","blob","'s ",(0,n.jsx)(i.code,{children:"QuiltPatchId"})," changes if it's moved to a different quilt."]}),"\n",(0,n.jsxs)(i.p,{children:["Standard ","blob"," operations like ",(0,n.jsx)(i.code,{children:"delete"}),", ",(0,n.jsx)(i.code,{children:"extend"}),", or ",(0,n.jsx)(i.code,{children:"share"})," cannot target individual ","blobs"," inside a quilt; they must be applied to the entire quilt."]}),"\n",(0,n.jsxs)(i.p,{children:["To store all files from one or more directories recursively, use the ",(0,n.jsx)(i.code,{children:"--paths"})," flag. The filename of each file is used as its unique identifier within the quilt. Regular expressions are supported for uploading from multiple paths."]}),"\n",(0,n.jsxs)(i.p,{children:["Like the regular ",(0,n.jsx)(i.code,{children:"store"})," command, you can specify the storage duration using ",(0,n.jsx)(i.code,{children:"--epochs"}),", ",(0,n.jsx)(i.code,{children:"--earliest-expiry-time"}),", or ",(0,n.jsx)(i.code,{children:"--end-epoch"}),"."]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-sh",children:"$ walrus store-quilt --epochs <EPOCHS> --paths <path-to-directory-1> <path-to-directory-2> <path-to-blob>\n"})}),"\n",(0,n.jsxs)(i.p,{children:["You must ensure that all the identifiers are unique within a quilt, the operation fails otherwise. Identifiers are the unique names used to retrieve individual ","blobs"," from within the quilt."]}),"\n",(0,n.jsxs)(i.p,{children:["To specify a list of ","blobs"," as JSON objects, use the ",(0,n.jsx)(i.code,{children:"--blobs"})," flag. This gives you more control, allowing you to set a custom ",(0,n.jsx)(i.code,{children:"identifier"})," and ",(0,n.jsx)(i.code,{children:"tags"})," for each file. If ",(0,n.jsx)(i.code,{children:"identifier"})," is ",(0,n.jsx)(i.code,{children:"null"})," or omitted, the file's name is used instead."]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-sh",children:'$ walrus store-quilt \\\n    --blobs \'{"path":"<path-to-blob-1>","identifier":"walrus","tags":{"color":"grey","size":"medium"}}\' \\\n            \'{"path":"<path-to_blob-2>","identifier":"seal","tags":{"color":"grey","size":"small"}}\' \\\n    --epochs <EPOCHS>\n'})})]})}function h(e={}){let{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}function u(e,i){throw Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},5756(e,i,s){s.d(i,{R:()=>l,x:()=>r});var t=s(9471);let n={},o=t.createContext(n);function l(e){let i=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function r(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),t.createElement(o.Provider,{value:i},e.children)}}}]);